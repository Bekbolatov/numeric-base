var e,_initLocal;(_initLocal=function(a){var b;return void 0===a.numeric?void console.log("wrong init order..."):(b=a.numeric,b.appGroup="com.sparkydots.apps",b.appVersion=1,b.appName="Admin",b.key.settings="numeric"+b.appName+"Settings",b.key.deviceId="numeric"+b.appName+"DeviceId",b.key.currentActivitySummary="numeric"+b.appName+"CurrentActivitySummary",b.key.storedActivitySummaries="numeric"+b.appName+"StoredActivitySummaries",b.key.messages="numeric"+b.appName+"Messages",b.key.channelActivities="numeric"+b.appName+"ChannelActivitiesCache",b.url.base.numeric="numericdata/",b.url.base.fs="numericdata/"+b.appName+"/",b.path.touch="touch",b.path.channels="channels",b.path.list="activity/list",b.path.activity="activity/",b.path.body="activity/body/",b.path.result="result/",void 0===b.defaultSettings&&b.defaultSettings==={},b.defaultSettings.defaultChannel="public.1000",b.defaultSettings.stringTitle=b.appName,b.defaultSettings.stringActivities="Activities",b.defaultSettings.stringHistory="History",b.defaultSettings.stringHistoryItem="Activity Summary",b.defaultSettings.showTabPractice=!1,b.defaultSettings.showTabHistory=!1,b.defaultSettings.showSettings=!0,b.customTabs=[{page:"activities",text:"Activities"},{page:"channels",text:"Channels"},{page:"endUserProfiles",text:"EndUserProfiles"},{page:"permissions",text:"Permissions"}])})(document);try{!function(a){var b,c,d,e;return c=location.protocol,d=location.hostname,b=location.port,b.length>0&&(b=":"+b),e=c+"//"+d+b,a.document.numeric.url.base.chrome=a.document.numeric.url.base.chrome.replace("SERVERNAME",e),"localhost"===d&&":9000"===b?(a.document.numeric.url.base.chrome="filesystem:http://localhost:9000/temporary/",a.document.numeric.defaultSettings.mainServerAddress="http://localhost:9000/activityServer/data/",a.document.numeric.defaultSettings.showSettings=!0):void 0}(this)}catch(_error){e=_error,console.log(e)}angular.module("Admin",["ngRoute","ngMd5","timer","ModulePersistence","ModuleSettings","ModuleMessage","BaseLib","ModuleIdentity","ModuleCommunication","ModuleDataPack","ModuleDataUtilities","ActivityLib"]),angular.module("Admin").controller("ActivitiesCtrl",["$scope","$location","$route","$sce","Settings","Tracker","Application","ServerHttp",function(a,b,c,d,e,f,g,h){return e.ready?(f.touch("activities"),a.startIndex=g.getVar("activitiesCurrentPage",0),a.pageSize=e.get("pageSize"),a.endIndex=a.startIndex+a.pageSize,a.turnPage=function(b){if(a.startIndex+b<=0){if(0===a.startIndex)return 1;a.startIndex=0}else if(0>b)a.startIndex=a.startIndex-a.pageSize;else{if(a.endIndex<a.startIndex+a.pageSize)return 1;a.startIndex=a.startIndex+a.pageSize}return g.setVar("activitiesCurrentPage",a.startIndex),a.endIndex=a.startIndex+a.pageSize,a.refreshView()},a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1,a.refreshView=function(){return h.get("/activityServer/admin/activity?startIndex="+a.startIndex+"&size="+a.pageSize).then(function(b){return a.activities=b.data.activities})},a.showEditForm=function(b){return a.showFormEdit=!0,a.editing=!0,a.adding=!1,a.deleting=!1,h.get("/activityServer/admin/activity/"+b).then(function(b){return a.formData=b.data,a.formDataOriginal=angular.copy(a.formData)})["catch"](function(b){return console.log(b),a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1})},a.updateForm=function(){return a.formData.errors={},a.formData.authorDate="2014-09-14",h.post("/activityServer/admin/activity/"+a.formDataOriginal.id,a.formData).then(function(){return a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1,a.refreshView()})["catch"](function(b){var c,d,e,f;e=b.data,f=[];for(d in e)c=e[d],f.push(a.formData.errors[d]="error");return f})},a.createForm=function(){return a.formData.errors={},a.formData.authorDate=(new Date).format("yyyy-mm-dd"),h.post("/activityServer/admin/activity",a.formData).then(function(){return a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1,a.refreshView()})["catch"](function(b){var c,d,e,f;e=b.data,f=[];for(d in e)c=e[d],f.push(a.formData.errors[d]="error");return f})},a.showDeleteActivity=function(b){return a.editing=!1,a.adding=!1,a.deleting=!0,a.deletingActivity=b},a.deleteActivity=function(b){var c,d,e,f,g;return d=location.protocol,e=location.hostname,c=location.port,c.length>0&&(c=":"+c),f=d+"//"+e+c,g="/activityServer/admin/activity/"+b,h["delete"](g).then(function(){return console.log("ok"),a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1})["catch"](function(a){return console.log(a)}).then(function(){return a.refreshView()})},a.backButton=function(){return a.showFormEdit===!0?(a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1):b.path("/")},a.refreshView()):b.path("/")}]),angular.module("Admin").controller("ApplicationCtrl",["$scope","$location","$route","Settings","Application",function(a,b,c,d){var e;return e=function(){return b.path("/home"),c.reload()},d.ready?e():(a.settingsLoaded=!1,d.init(document.numeric.key.settings,document.numeric.defaultSettings).then(function(){return function(){return e()}}(this))["catch"](function(){return function(){return a.errorMessage="Application needs some local storage enabled to work."}}(this)))}]),angular.module("Admin").controller("ChannelsCtrl",["$scope","$location","$sce","Settings","Tracker","Application","ServerHttp",function(a,b,c,d,e,f,g){return d.ready?(e.touch("channels"),a.startIndex=f.getVar("channelsCurrentPage",0),a.pageSize=d.get("pageSize"),a.endIndex=a.startIndex+a.pageSize,a.turnPage=function(b){if(a.startIndex+b<=0){if(0===a.startIndex)return 1;a.startIndex=0}else if(0>b)a.startIndex=a.startIndex-a.pageSize;else{if(a.endIndex<a.startIndex+a.pageSize)return 1;a.startIndex=a.startIndex+a.pageSize}return f.setVar("channelsCurrentPage",a.startIndex),a.endIndex=a.startIndex+a.pageSize,a.refreshView()},a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1,a.managingActivities=!1,a.refreshView=function(){return g.get("/activityServer/admin/channel?startIndex="+a.startIndex+"&size="+a.pageSize).then(function(b){return a.channels=b.data.channels})},a.showEditForm=function(b){return a.showFormEdit=!0,a.editing=!0,a.adding=!1,a.deleting=!1,g.get("/activityServer/admin/channel/"+b).then(function(b){return a.formData=b.data,a.formDataOriginal=angular.copy(a.formData)})["catch"](function(b){return console.log(b),a.showFormEdit=!1})},a.updateForm=function(){return a.formData.errors={},a.formData.createDate="2014-09-14",g.post("/activityServer/admin/channel/"+a.formDataOriginal.id,a.formData).then(function(){return a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1,a.refreshView()})["catch"](function(b){var c,d,e,f;e=b.data,f=[];for(d in e)c=e[d],f.push(a.formData.errors[d]="error");return f})},a.showCreateForm=function(){return a.formData={},a.formData.errors={},a.formData.createDate=(new Date).format("yyyy-mm-dd"),a.showFormEdit=!0,a.editing=!1,a.adding=!0,a.deleting=!1},a.createForm=function(){return a.formData.errors={},a.formData.createDate=(new Date).format("yyyy-mm-dd"),g.post("/activityServer/admin/channel",a.formData).then(function(){return a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1,a.refreshView()})["catch"](function(b){var c,d,e,f;e=b.data,f=[];for(d in e)c=e[d],f.push(a.formData.errors[d]="error");return f})},a.showDeleteChannel=function(b){return a.editing=!1,a.adding=!1,a.deleting=!0,a.deletingChannel=b},a.deleteChannel=function(b){var c,d,e,f,h;return d=location.protocol,e=location.hostname,c=location.port,c.length>0&&(c=":"+c),f=d+"//"+e+c,h="/activityServer/admin/channel/"+b,g["delete"](h).then(function(){return console.log("ok"),a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1})["catch"](function(a){return console.log(a)}).then(function(){return a.refreshView()})},a.showManageActivities=function(b){return a.activitiesManage={},a.activitiesManageHere={},a.managingChannel=b,a.managingActivities=!0,g.get("/activityServer/admin/channel/"+b+"/activities").then(function(b){var c,d,e,f;for(a.activitiesHere=b.data.activities,f=a.activitiesHere,d=0,e=f.length;e>d;d++)c=f[d],a.activitiesManageHere[c.id]=1;return g.get("/activityServer/admin/activity").then(function(b){var d,e,f,g;for(a.activitiesAll=b.data.activities,f=a.activitiesAll,g=[],d=0,e=f.length;e>d;d++)c=f[d],a.activitiesManage[c.id]=c,g.push(1===a.activitiesManageHere[c.id]?a.activitiesManage[c.id].included=!0:void 0);return g})})},a.toggleMembership=function(b){return a.activitiesManage[b].included?(a.activitiesManage[b].included=!1,g.post("/activityServer/admin/channel/"+a.managingChannel+"/remove/"+b).then(function(){return a.activitiesManage[b].included=!1})["catch"](function(c){return console.log(c),a.activitiesManage[b].included=!0})):(a.activitiesManage[b].included=!0,g.post("/activityServer/admin/channel/"+a.managingChannel+"/add/"+b).then(function(){return a.activitiesManage[b].included=!0})["catch"](function(c){return console.log(c),a.activitiesManage[b].included=!1}))},a.backButton=function(){return a.showFormEdit===!0?(a.showFormEdit=!1,a.editing=!1,a.adding=!1,a.deleting=!1,a.managingActivities=!1):b.path("/")},a.refreshView()):b.path("/")}]),angular.module("Admin").controller("EndUserProfilesCtrl",["$scope","$location","$sce","Settings","Application","ServerHttp",function(a,b,c,d,e,f){return f.get("/activityServer/admin/profile?startIndex=0&size=100").then(function(b){return a.endUserProfiles=b.data.endUserProfiles})}]),angular.module("Admin").directive("formatdate",["$filter",function(a){return{restrict:"A",require:"ngModel",link:function(b,c,d,e){return e.$formatters.push(function(b){return a("epochToDate")(b)}),e.$parsers.push(function(a){return a})}}}]),angular.module("Admin").config(["$routeProvider",function(a){return a.when("/jojo",{templateUrl:"/assets/apps/Admin/templates/history.html",controller:"HistoryCtrl"})}]),angular.module("Admin").factory("Application",["$sce","Settings","DeviceId",function(a,b,c){var d,e;return d=function(){function b(){this.vars={},this.customDisplay={},this.customDisplay.content=a.trustAsHtml('<span class="yourId">Your ID:<br>'+c.devicePublicId+"</span>")}return b.prototype.getVar=function(a,b){var c;return c=this.vars[a],void 0===c&&(c=b),c},b.prototype.setVar=function(a,b){return this.vars[a]=b},b}(),e=new d,document.numeric.application=e,e}]);